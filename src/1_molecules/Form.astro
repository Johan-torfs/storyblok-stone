---
import { type SbBlokData } from '@storyblok/astro';
// @ts-ignore
import StoryblokComponent from "@storyblok/astro/StoryblokComponent.astro";
import RatingForm from './forms/RatingForm.svelte';

interface StoryblokFormState extends SbBlokData {
    component: 'form_state',
    content: [SbBlokData],
    type: "intermediate" | "final" | "post-submit";
}

interface StoryblokForm extends SbBlokData {
    component: 'form',
    states: [StoryblokFormState],
    padding?: 0|2|4|6|8|16|24;
    type: "rating";
}

interface Props {
    blok: StoryblokForm;
}

const { blok } = Astro.props;
---
{blok.states.length > 10 ? <div class="bg-red-500 text-white p-4">You can only have up to 10 states in a form</div> : null}
{blok.type == "rating" ? 
    <RatingForm blok={blok} client:load>
        {blok.states[0] ? () => {   
            return <Fragment slot="name-0">
                {blok.states[0].content.map(item => {
                    return <StoryblokComponent blok={item} />
                })}
            </Fragment>
        } : null}
        {blok.states[1] ? () => {   
            return <Fragment slot="name-1">
                {blok.states[1].content.map(item => {
                    return <StoryblokComponent blok={item} />
                })}
            </Fragment>
        } : null}
    </RatingForm> 
    : null
}